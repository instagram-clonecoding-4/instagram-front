<!-- TODO : 로그인 테스트를 위함 -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <form>
      <input type="text" id="login" placeholder="id " />
      <input type="text" id="pw" placeholder="pw " />
      <button type="button" id="submit">버튼</button>
    </form>
    <script>
      document.addEventListener('DOMContentLoaded', () => {
        const login = document.getElementById('login');
        const pw = document.getElementById('pw');
        const submit = document.getElementById('submit');

        submit.addEventListener('click', async () => {
          const req = await fetch('http://localhost:7777/login', {
            method: 'POST',

            headers: {
              'Content-Type': 'application/json',
            },

            body: JSON.stringify({
              email: login.value,
              password: pw.value,
            }),
          });
          if (req.ok) {
            const loginUser = await req.json();
            const userId = loginUser.id;
            window.localStorage.setItem('id', userId);

            window.location.href = `./pages/main-page.html?id=${userId}`;
          } else {
            const error = await req.json();
            alert(`로그인 또는 비밀번호를 다시 확인해주세요`);
            console.error('로그인 실패:', error.message);
          }
        });
      });
    </script>
  </body>
</html>
